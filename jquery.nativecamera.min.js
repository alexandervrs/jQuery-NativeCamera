;(function(e){var t="nativeCamera";var n={create:function(t){var n={width:320,height:240,background:"none",sendData:false,sendURL:"capture.php",sendFilename:"capture",imageQuality:100,create:function(){},start:function(){},stop:function(){},capture:function(e){},beforeSend:function(){},afterSend:function(){},unsupportedAPIError:function(){},deviceError:function(){},userPermissionError:function(){},captureError:function(){},sendError:function(){}};var t=e.extend(n,t);return e(this).each(function(n,r){e(r).data("plugin-options",t);if(!(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)){t.unsupportedAPIError();e(r).data("plugin-options",null);return false}t.create()})},start:function(){return e(this).each(function(t,n){var r=e(n).data("plugin-options");if(!r){return false}e(this).html('<video autoplay id="nativecamera-'+e(this).attr("id")+'" oncontextmenu="return false"></video>');var i=e("#nativecamera-"+e(this).attr("id"))[0];e(i).css({display:"block",width:r.width,height:r.height,background:r.background});e(i).attr({width:r.width,height:r.height,autoplay:"autoplay"});e(i).removeAttr("controls");window.URL=window.URL||window.webkitURL;navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;if(navigator.getUserMedia){navigator.getUserMedia({video:true},function(t){if(navigator.getUserMedia==navigator.mozGetUserMedia){e(i)[0].mozSrcObject=t}else{e(i)[0].src=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(t):t}e(i)[0].play();r.start()},function(){r.userPermissionError()})}else{r.deviceError()}})},capture:function(t){return e(this).each(function(t,n){var r=e(n).data("plugin-options");if(!r){return false}var i=e("#nativecamera-"+e(this).attr("id"))[0];if(!e("#nativecamera-canvas-"+e(this).attr("id"))[0]){e(i).after('<canvas id="nativecamera-canvas-'+e(this).attr("id")+'" style="display: none; background: #fff;"></canvas>')}var s=e("#nativecamera-canvas-"+e(this).attr("id"))[0];if(s&&i){var o=e(s)[0].getContext("2d")}else{r.captureError();return false}e(s).css("display","none");e(s).attr("width",r.width);e(s).attr("height",r.height);o.drawImage(i,0,0,r.width,r.height);if(r.sendData==true){e.ajax({url:r.sendURL,type:"POST",cache:false,data:{imagedata:s.toDataURL("image/jpeg",r.imageQuality),filename:r.sendFilename},beforeSend:function(){r.beforeSend()},success:function(e){r.afterSend()},error:function(){r.sendError()}})}r.capture(s.toDataURL("image/jpeg",r.imageQuality))})},stop:function(){return e(this).each(function(t,n){var r=e(n).data("plugin-options");if(!r){return false}var i="#nativecamera-"+e(this).attr("id");e(i).attr("src","");e(i)[0].mozSrcObject=null;e(i).removeAttr("autoplay");e(i).stop();r.stop()})},destroy:function(){return e(this).each(function(t,n){var r=e(n).data("plugin-options");if(!r){return false}e("#nativecamera-"+e(this).attr("id")).remove();e("#nativecamera-canvas-"+e(this).attr("id")).remove();r.destroy();e(n).data("plugin-options",null)})},setOption:function(t,n){return e(this).each(function(r,i){var s=e(i).data("plugin-options");if(!s){return false}e(i).data("plugin-options")[t]=n})}};e.fn.nativeCamera=function(r){if(n[r]){return n[r].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof r==="object"||!r){return n.create.apply(this,arguments)}else{e.error("Method "+r+" does not exist in "+t)}}})(jQuery);